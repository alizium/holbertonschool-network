#!/usr/bin/env bash

set -euo pipefail

if command -v ss >/dev/null 2>&1; then
  # ss = moderne ; -l listening, -p PID/prog, -u UDP, -t TCP, -n numérique, -e extra
  sudo ss -lpunet
elif command -v netstat >/dev/null 2>&1; then
  # fallback netstat
  sudo netstat -lpunet
elif command -v lsof >/dev/null 2>&1; then
  # dernier recours
  sudo lsof -nP -iTCP -sTCP:LISTEN -iUDP
else
  echo "Aucun outil trouvé (ss/netstat/lsof). Installe iproute2, net-tools ou lsof." >&2
  exit 1
fi

#!/usr/bin/env bash

# Affiche toutes les adresses IPv4 actives sur la machine
set -euo pipefail

# Vérifie si la commande ip est disponible
if command -v ip >/dev/null 2>&1; then
  # Si oui : affiche les adresses IPv4 et enlève le masque réseau
  ip -4 -o addr show | awk '{print $4}' | cut -d/ -f1
else
  # Sinon : récupère les IP avec hostname -I
  out="$(hostname -I 2>/dev/null || true)"
  # Vérifie si la sortie n’est pas vide
  if [[ -n "${out:-}" ]]; then
    # Affiche les IP trouvées
    printf "%s\n" $out
  fi
  # Ajoute l’IP de localhost si disponible
  getent hosts localhost 2>/dev/null | awk '{print $1}' | sort -u
fi
